<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>DEPINS STORE | Final Version</title>
<style>
:root {
  --primary-red: #D60000;
  --primary-gold: #FFD700;
  --dark-bg: #050505;
  --card-bg: #141414;
  --text-white: #e0e0e0;
}
* { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
body {
  margin: 0; font-family: 'Segoe UI', sans-serif;
  color: var(--text-white);
  background: radial-gradient(circle at center, #1a0505 0%, #000000 100%);
  min-height: 100vh; padding-bottom: 20px;
}

/* --- HEADER & NAV (UPDATED) --- */
header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 15px 5%; background: rgba(0,0,0,0.95);
  border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 100;
  backdrop-filter: blur(10px);
}
.logo { font-size: 26px; font-weight: 900; letter-spacing: 1px; text-transform: uppercase; }
.logo span { color: var(--primary-red); }

.nav-links { display: flex; gap: 25px; align-items: center; }
/* Font Size & Weight Increased */
.nav-links a { 
    color: #ccc; text-decoration: none; 
    font-size: 1.1rem; /* –¢–æ–º—Ä—É—É–ª—Å–∞–Ω */
    font-weight: 700;  /* –¢–æ–¥—Ä—É—É–ª—Å–∞–Ω */
    text-transform: uppercase;
    transition: 0.3s; 
}
.nav-links a:hover { color: var(--primary-red); }

.icon-btn { background: none; border: none; color: white; font-size: 1.3rem; cursor: pointer; position: relative; }
.badge-count { 
  position: absolute; top: -5px; right: -8px; background: var(--primary-red); 
  color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; font-weight: bold;
}
.hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; }
.hamburger div { width: 25px; height: 3px; background: white; transition: 0.3s; }

.mobile-menu {
  position: fixed; top: 60px; left: 0; width: 100%; background: #111;
  padding: 20px; display: none; border-bottom: 1px solid #333; z-index: 99;
}
.mobile-menu a { display: block; padding: 15px 0; color: white; text-decoration: none; border-bottom: 1px solid #222; font-weight: bold; font-size: 1.1rem; }

/* --- HERO --- */
.hero {
  height: 400px; display: flex; align-items: center; padding-left: 5%;
  background: url('https://images.unsplash.com/photo-1523398002811-999ca8dec234?q=80&w=1000&auto=format&fit=crop') center/cover;
  position: relative;
}
.hero::after { content:''; position: absolute; inset:0; background: linear-gradient(90deg, #000 0%, transparent 100%); }
.hero-content { position: relative; z-index: 2; }
.hero h1 { font-size: 3.5rem; margin: 0; line-height: 1; text-transform: uppercase; }

/* --- CONTROLS --- */
.controls-bar {
  padding: 20px 5%; display: flex; flex-wrap: wrap; gap: 15px; align-items: center;
  background: #0a0a0a; border-bottom: 1px solid #222;
}
.search-box { display: flex; background: #222; border-radius: 4px; border: 1px solid #333; overflow: hidden; }
.search-box input { background: transparent; border: none; color: white; padding: 8px 12px; width: 200px; }
select.filter-select { padding: 8px; background: #222; color: white; border: 1px solid #333; border-radius: 4px; }

/* --- PRODUCTS --- */
.products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; padding: 30px 5%; }
.product-card { background: var(--card-bg); border-radius: 8px; overflow: hidden; position: relative; transition: transform 0.3s; border: 1px solid #222; }
.product-card:hover { transform: translateY(-5px); border-color: #444; }
.card-badge { position: absolute; top: 10px; left: 10px; padding: 4px 8px; font-size: 0.75rem; font-weight: bold; border-radius: 4px; z-index: 2; text-transform: uppercase; }
.badge-sale { background: var(--primary-red); color: white; }
.img-container { height: 250px; overflow: hidden; background: #1a1a1a; cursor: pointer; }
.img-container img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
.product-card:hover img { transform: scale(1.05); }
.card-info { padding: 15px; }
.card-title { font-weight: 600; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-price { font-weight: bold; font-size: 1.1rem; }
.old-price { text-decoration: line-through; color: #666; font-size: 0.9rem; margin-right: 8px; }
.card-actions { margin-top: 15px; display: grid; grid-template-columns: 3fr 1fr; gap: 5px; }
.btn-add { background: var(--primary-red); color: white; border: none; padding: 8px; border-radius: 4px; cursor: pointer; font-weight: bold; }
.btn-view { background: #333; color: white; border: none; border-radius: 4px; cursor: pointer; }

/* --- CART DRAWER --- */
/* Overlay for clicking outside */
#cartOverlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 199;
    display: none; backdrop-filter: blur(2px);
}
#cartOverlay.show { display: block; }

#cartDrawer { 
    position: fixed; top: 0; right: -360px; width: 340px; height: 100%; 
    background: #111; z-index: 200; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    box-shadow: -5px 0 20px rgba(0,0,0,0.8); display: flex; flex-direction: column; 
}
#cartDrawer.open { right: 0; }

.cart-header { padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
.cart-items { flex-grow: 1; overflow-y: auto; padding: 15px; }
.cart-item { display: flex; gap: 10px; margin-bottom: 15px; background: #1a1a1a; padding: 10px; border-radius: 6px; align-items: center; }
.cart-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 4px; }
.cart-footer { padding: 20px; background: #111; border-top: 1px solid #333; }

/* Remove Button Icon Style */
.btn-remove { 
    background: #2a0a0a; border: 1px solid #3a1111; color: #ff4444; 
    width: 35px; height: 35px; border-radius: 50%; 
    display: flex; align-items: center; justify-content: center; 
    cursor: pointer; transition: 0.2s;
}
.btn-remove:hover { background: var(--primary-red); color: white; border-color: var(--primary-red); }
.btn-remove svg { width: 16px; height: 16px; fill: currentColor; }

/* --- MODALS --- */
.modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
.modal-content { background: #1a1a1a; width: 90%; max-width: 600px; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; max-height: 90vh; overflow-y: auto; }
.form-input { width: 100%; padding: 12px; background: #222; border: 1px solid #444; color: white; border-radius: 4px; margin-bottom: 10px; }

/* --- ADMIN PANEL --- */
#adminActions { padding: 20px; }
.admin-row { display: flex; gap: 10px; margin-bottom: 10px; }

/* --- PAYMENT STEPS --- */
.step-container { display: none; padding: 20px; }
.step-container.active { display: block; animation: fadeIn 0.3s; }
.payment-methods { display: flex; gap: 10px; margin-bottom: 20px; }
.pm-btn { flex: 1; padding: 15px; background: #222; border: 2px solid #333; color: #888; border-radius: 8px; cursor: pointer; text-align: center; }
.pm-btn.active { border-color: var(--primary-red); color: white; }
.pay-section { display: none; text-align: center; }
.pay-section.show { display: block; }

/* --- FOOTER --- */
footer { background: #080808; border-top: 1px solid #222; padding: 50px 5% 20px; margin-top: 50px; }
.footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; }
.social-link { display: flex; align-items: center; gap: 10px; color: #888; text-decoration: none; margin-bottom: 10px; }
.social-link:hover { color: var(--primary-red); }

@keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
@media(max-width: 768px) {
  .nav-links { display: none; }
  .hamburger { display: flex; }
  .products-grid { grid-template-columns: 1fr 1fr; gap: 15px; }
}
</style>
</head>
<body>

<header>
  <div class="hamburger" onclick="toggleMenu()"><div></div><div></div><div></div></div>
  <div class="logo">DEPINS <span>store</span></div>
  <div class="nav-links">
    <a href="#">–ù“Ø“Ø—Ä</a>
    <a href="#products">–ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω</a>
    <a href="#footer">–•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö</a>
  </div>
  <div style="display:flex; gap:15px; align-items:center;">
    <button class="icon-btn" onclick="openAdmin()">‚öôÔ∏è</button>
    <button class="icon-btn" onclick="toggleCart()">üõí <span class="badge-count" id="cartCount">0</span></button>
  </div>
</header>

<div class="mobile-menu" id="mobileMenu">
  <a href="#" onclick="toggleMenu()">–ù“Ø“Ø—Ä</a>
  <a href="#products" onclick="toggleMenu()">–ë“Ø—Ç—ç—ç–≥–¥—ç—Ö“Ø“Ø–Ω</a>
  <a href="#footer" onclick="toggleMenu()">–•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö</a>
</div>

<div class="modal" id="adminModal">
  <div class="modal-content" style="max-width: 400px;">
    <div style="padding: 20px; border-bottom: 1px solid #333; display:flex; justify-content:space-between;">
        <h3>Admin Panel</h3>
        <button onclick="closeAdmin()" style="background:none;border:none;color:#666;font-size:1.5rem;cursor:pointer;">&times;</button>
    </div>
    <div style="padding: 20px;">
        <div id="loginSection">
            <input type="password" id="adminPass" placeholder="–ù—É—É—Ü “Ø–≥ (1234)" class="form-input">
            <button onclick="loginAdmin()" style="width:100%; padding:10px; background:var(--primary-red); color:white; border:none; border-radius:4px;">–ù—ç–≤—Ç—Ä—ç—Ö</button>
        </div>
        <div id="adminActions" style="display:none; padding:0;">
            <p style="color:#aaa; margin-bottom:10px;">–®–∏–Ω—ç –±–∞—Ä–∞–∞ –Ω—ç–º—ç—Ö:</p>
            <input type="text" id="pName" placeholder="–ë–∞—Ä–∞–∞–Ω—ã –Ω—ç—Ä" class="form-input">
            <div class="admin-row">
                <input type="number" id="pPrice" placeholder="“Æ–Ω—ç" class="form-input">
                <select id="pCat" class="form-input">
                    <option value="Hoodie">Hoodie</option>
                    <option value="Pants">Pants</option>
                    <option value="T-Shirt">T-Shirt</option>
                </select>
            </div>
            <input type="text" id="pImage" placeholder="–ó—É—Ä–∞–≥ URL" class="form-input">
            <button onclick="saveProduct()" style="width:100%; padding:10px; background:var(--primary-red); color:white; border:none; border-radius:4px; font-weight:bold;">–•–ê–î–ì–ê–õ–ê–•</button>
        </div>
    </div>
  </div>
</div>

<section class="hero">
  <div class="hero-content">
    <h1>Street Style<br><span>Revolution</span></h1>
    <p style="color:#ccc; margin-top:10px; font-size: 1.1rem;">–®–∏–Ω—ç –∑–∞–≥–≤–∞—Ä—ã–Ω —Ü—É–≥–ª—É—É–ª–≥–∞ —Ö—É–¥–∞–ª–¥–∞–∞–Ω–¥ –≥–∞—Ä–ª–∞–∞.</p>
  </div>
</section>

<section id="products">
  <div class="controls-bar">
    <div class="search-box">
      <span style="padding:8px; color:#666;">üîç</span>
      <input type="text" id="searchInput" placeholder="–•–∞–π—Ö...">
    </div>
    <select class="filter-select" id="categoryFilter">
      <option value="all">–ë“Ø—Ö –∞–Ω–≥–∏–ª–∞–ª</option>
    </select>
  </div>
  <div class="products-grid" id="productsGrid"></div>
</section>

<div class="modal" id="productModal">
  <div class="modal-content" style="max-width:800px; display:grid; grid-template-columns: 1fr 1fr;">
    <div style="height:400px; background:#000;">
      <img id="modalImg" src="" style="width:100%; height:100%; object-fit:contain;">
    </div>
    <div style="padding:30px; display:flex; flex-direction:column; justify-content:center;">
      <h2 id="modalTitle" style="margin:0 0 10px 0;">Product</h2>
      <h3 id="modalPrice" style="color:var(--primary-red); margin-bottom:20px;">‚ÇÆ0</h3>
      <label style="color:#aaa;">–†–∞–∑–º–µ—Ä:</label>
      <select id="modalSize" style="width:100%; padding:10px; background:#222; color:white; border:1px solid #333; margin:5px 0 20px;"></select>
      <button id="modalAddToCart" style="padding:15px; background:var(--primary-red); color:white; border:none; font-weight:bold;">–°–ê–ì–°–ê–ù–î –•–ò–ô–•</button>
      <button onclick="document.getElementById('productModal').style.display='none'" style="padding:10px; background:none; color:#666; border:none; margin-top:10px;">–•–∞–∞—Ö</button>
    </div>
  </div>
</div>

<div class="modal" id="orderModal">
  <div class="modal-content">
    <div style="padding: 20px; border-bottom: 1px solid #333; display:flex; justify-content:space-between; align-items:center;">
      <h3 style="margin:0;" id="orderTitle">–•“Ø—Ä–≥—ç–ª—Ç–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª</h3>
      <button onclick="closeOrder()" style="background:none; border:none; color:#666; font-size:1.5rem; cursor:pointer;">&times;</button>
    </div>
    
    <div id="stepInfo" class="step-container active">
        <input type="text" id="userName" class="form-input" placeholder="–¢–∞–Ω—ã –Ω—ç—Ä *">
        <input type="number" id="userPhone" class="form-input" placeholder="–£—Ç–∞—Å–Ω—ã –¥—É–≥–∞–∞—Ä *">
        <textarea id="userAddress" class="form-input" placeholder="–•“Ø—Ä–≥“Ø“Ø–ª—ç—Ö —Ö–∞—è–≥ *" style="min-height:80px;"></textarea>
        <button onclick="goToPayment()" style="width:100%; padding:15px; background:var(--primary-red); color:white; border:none; font-weight:bold; border-radius:4px;">–¢”®–õ–ë”®–† –°–û–ù–ì–û–• ‚ûù</button>
    </div>

    <div id="stepPayment" class="step-container">
        <div style="margin-bottom:20px; padding:10px; background:#222; border-radius:4px; font-size:0.9rem;">
            –ó–∞—Ö–∏–∞–ª–∞–≥—á: <span id="summaryName" style="font-weight:bold; color:white;"></span><br>
            –î“Ø–Ω: <span id="summaryTotal" style="font-weight:bold; color:var(--primary-red);"></span>
        </div>
        <div class="payment-methods">
          <div class="pm-btn active" onclick="switchPayment('qpay', this)">üì± QPay</div>
          <div class="pm-btn" onclick="switchPayment('social', this)">üí¨ Social</div>
          <div class="pm-btn" onclick="switchPayment('card', this)">üí≥ –ö–∞—Ä—Ç</div>
        </div>
        <div class="payment-body">
          <div id="qpay" class="pay-section show">
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=DepinsStore" style="background:white; padding:10px; border-radius:8px;">
          </div>
          <div id="social" class="pay-section">
            <button style="background:#ff6b00; color:white; padding:12px 30px; border-radius:25px; border:none; font-weight:bold;">SocialPay App</button>
          </div>
          <div id="card" class="pay-section">
             <p style="color:#888;">–ö–∞—Ä—Ç —É–Ω—à–∏–≥—á —Ö–æ–ª–±–æ–≥–¥–æ–æ–≥“Ø–π –±–∞–π–Ω–∞.</p>
          </div>
        </div>
        <div style="display:flex; gap:10px; margin-top:20px;">
            <button onclick="backToInfo()" style="flex:1; padding:15px; background:#333; color:white; border:none;">‚Üê –ë—É—Ü–∞—Ö</button>
            <button onclick="completeOrder()" style="flex:2; padding:15px; background:var(--primary-red); color:white; border:none; font-weight:bold;">–ë–ê–¢–ê–õ–ì–ê–ê–ñ–£–£–õ–ê–•</button>
        </div>
    </div>
  </div>
</div>

<div id="cartOverlay" onclick="toggleCart()"></div> <div id="cartDrawer">
  <div class="cart-header">
    <h3>–¢–∞–Ω—ã —Å–∞–≥—Å</h3>
    <button onclick="toggleCart()" style="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer;">&times;</button>
  </div>
  <div class="cart-items" id="cartItems"></div>
  <div class="cart-footer">
    <div style="display:flex; justify-content:space-between; font-size:1.2rem; font-weight:bold; margin-bottom:15px;">
      <span>–ù–∏–π—Ç:</span> <span id="cartTotal">‚ÇÆ0</span>
    </div>
    <button onclick="startCheckout()" style="width:100%; padding:15px; background:var(--primary-red); color:white; border:none; font-weight:bold;">–ó–ê–•–ò–ê–õ–ê–•</button>
  </div>
</div>

<footer id="footer">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>–ë–∏–¥–Ω–∏–π —Ç—É—Ö–∞–π</h4>
      <p style="color:#888; font-size:0.9rem;">DEPINS STORE. Street Fashion Brand.</p>
    </div>
    <div class="footer-col">
      <h4>–•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö</h4>
      <ul>
        <li>üìå –°–ë–î 8-—Ä —Ö–æ—Ä–æ–æ GB center –±–∞—Ä—É—É–Ω —Ö–∞–∞–ª–≥–∞ B1 –¥–∞–≤—Ö–∞—Ä</li>
        <li>üìû +976 8683-6400</li>
        <li>
            <a href="https://www.instagram.com/depins_store?igsh=MWp0NnU1ZHM1eDJ4cg==" target="_blank" class="social-link">
                <svg viewBox="0 0 48 48" style="width:24px; height:24px;">
                    <radialGradient id="ig-gradient" cx="0.25" cy="0.75" r="1.5">
                        <stop offset="0" stop-color="#fd5"/>
                        <stop offset=".4" stop-color="#ff543f"/>
                        <stop offset="1" stop-color="#c13584"/>
                    </radialGradient>
                    <path fill="url(#ig-gradient)" d="M36 4H12c-4.4 0-8 3.6-8 8v24c0 4.4 3.6 8 8 8h24c4.4 0 8-3.6 8-8V12c0-4.4-3.6-8-8-8zm-12 32c-6.6 0-12-5.4-12-12s5.4-12 12-12 12 5.4 12 12-5.4 12-12 12zm10-23a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/>
                    <circle cx="24" cy="24" r="8" fill="#fff"/>
                </svg>
                Instagram
            </a>
        </li>
      </ul>
    </div>
  </div>
  <div style="text-align:center; color:#444; font-size:0.85rem; padding-top:20px; border-top:1px solid #222;">&copy; 2025 DEPINS Store.</div>
</footer>

<script>
/* --- DATA --- */
let products = JSON.parse(localStorage.getItem('depins_pro_products')) || [
  { name: 'Oversize Hoodie', price: 85000, salePrice: 65000, isSale: true, image: 'https://images.unsplash.com/photo-1556905055-8f358a7a47b2?q=80&w=500', category: 'Hoodie', stock: 15, sizes: ['M','L','XL'] },
  { name: 'Cargo Pants', price: 95000, salePrice: null, isSale: false, image: 'https://images.unsplash.com/photo-1624378439575-d8705ad7ae80?q=80&w=500', category: 'Pants', stock: 8, sizes: ['30','32'] }
];
let cart = JSON.parse(localStorage.getItem('depins_pro_cart')) || [];
let activeFilters = { category: 'all', search: '', saleOnly: false };
let orderData = {};

/* --- INIT --- */
function init() { renderProducts(); updateCartUI(); updateFilters(); }

/* --- PRODUCT & ADMIN FUNCTIONS --- */
function renderProducts() {
  const grid = document.getElementById('productsGrid');
  grid.innerHTML = '';
  const filtered = products.filter(p => {
    return (activeFilters.category === 'all' || p.category === activeFilters.category) &&
           (p.name.toLowerCase().includes(activeFilters.search.toLowerCase()));
  });
  
  filtered.forEach((p, index) => {
    const priceHtml = p.isSale 
      ? `<span class="old-price">‚ÇÆ${p.price.toLocaleString()}</span> <span style="color:var(--primary-red)">‚ÇÆ${p.salePrice.toLocaleString()}</span>`
      : `<span>‚ÇÆ${p.price.toLocaleString()}</span>`;
    
    const div = document.createElement('div');
    div.className = 'product-card';
    div.innerHTML = `
      ${p.isSale ? '<div class="card-badge badge-sale">Sale</div>' : ''}
      <div class="img-container" onclick="openProductModal(${index})"><img src="${p.image}"></div>
      <div class="card-info">
        <div class="card-title">${p.name}</div>
        <div class="card-price">${priceHtml}</div>
        <div class="card-actions">
          <button class="btn-add" onclick="openProductModal(${index})">–°–ê–ì–°–õ–ê–•</button>
          <button class="btn-view" onclick="openProductModal(${index})">üëÅ</button>
        </div>
      </div>`;
    grid.appendChild(div);
  });
}

// ADMIN FUNCTIONALITY
function openAdmin() { document.getElementById('adminModal').style.display = 'flex'; }
function closeAdmin() { document.getElementById('adminModal').style.display = 'none'; }
function loginAdmin() {
    if(document.getElementById('adminPass').value === '1234') {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('adminActions').style.display = 'block';
    } else {
        alert("–ù—É—É—Ü “Ø–≥ –±—É—Ä—É—É!");
    }
}

function saveProduct() {
    const name = document.getElementById('pName').value;
    const price = parseInt(document.getElementById('pPrice').value);
    const cat = document.getElementById('pCat').value;
    const img = document.getElementById('pImage').value;

    if(!name || !price || !img) return alert("–ú—ç–¥—ç—ç–ª–ª–∏–π–≥ –≥“Ø–π—Ü—ç–¥ –æ—Ä—É—É–ª–Ω–∞ —É—É!");

    const newProd = {
        name: name,
        price: price,
        salePrice: null,
        isSale: false,
        image: img,
        category: cat,
        stock: 10,
        sizes: ['M','L']
    };

    products.push(newProd);
    localStorage.setItem('depins_pro_products', JSON.stringify(products)); // SAVE TO STORAGE
    
    renderProducts();
    updateFilters();
    
    alert("–ë–∞—Ä–∞–∞ –∞–º–∂–∏–ª—Ç—Ç–∞–π –Ω—ç–º—ç–≥–¥–ª—ç—ç!");
    
    // Reset Inputs
    document.getElementById('pName').value = '';
    document.getElementById('pPrice').value = '';
    document.getElementById('pImage').value = '';
}

function updateFilters() {
    const cats = ['all', ...new Set(products.map(p => p.category))];
    document.getElementById('categoryFilter').innerHTML = cats.map(c => `<option value="${c}">${c}</option>`).join('');
}

/* --- CART FUNCTIONS (FIXED) --- */
const toggleCart = () => {
    document.getElementById('cartDrawer').classList.toggle('open');
    document.getElementById('cartOverlay').classList.toggle('show');
}

function updateCartUI() {
    localStorage.setItem('depins_pro_cart', JSON.stringify(cart));
    const container = document.getElementById('cartItems');
    container.innerHTML = '';
    let totalAmount = 0;
    
    cart.forEach((item, idx) => {
        const price = item.isSale ? item.salePrice : item.price;
        totalAmount += price * item.qty;
        
        // Trash Icon SVG included inside button
        container.innerHTML += `
            <div class="cart-item">
                <img src="${item.image}">
                <div style="flex:1">
                    <div style="font-weight:bold;">${item.name}</div>
                    <div style="font-size:0.8rem; color:#888">${item.size} | x${item.qty}</div>
                    <div style="color:var(--primary-red)">‚ÇÆ${(price * item.qty).toLocaleString()}</div>
                </div>
                <button onclick="removeItem(${idx})" class="btn-remove" title="–£—Å—Ç–≥–∞—Ö">
                   <svg viewBox="0 0 24 24"><path d="M3 6h18v2H3V6zm2 3h14v13a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V9zm5 2v9h2v-9h-2zm4 0v9h2v-9h-2zM9 4V2h6v2h5v2H4V4h5z"/></svg>
                </button>
            </div>`;
    });
    
    document.getElementById('cartTotal').innerText = '‚ÇÆ' + totalAmount.toLocaleString();
    document.getElementById('cartCount').innerText = cart.reduce((a,b)=>a+b.qty,0);
}

function removeItem(idx) {
    cart.splice(idx, 1);
    updateCartUI();
}

/* --- ORDER & CHECKOUT LOGIC --- */
function startCheckout() {
    if(cart.length === 0) return alert('–°–∞–≥—Å —Ö–æ–æ—Å–æ–Ω –±–∞–π–Ω–∞.');
    toggleCart(); // Close cart
    document.getElementById('stepInfo').classList.add('active');
    document.getElementById('stepPayment').classList.remove('active');
    document.getElementById('orderModal').style.display = 'flex';
}

function closeOrder() { document.getElementById('orderModal').style.display = 'none'; }

function goToPayment() {
    const name = document.getElementById('userName').value;
    const phone = document.getElementById('userPhone').value;
    const address = document.getElementById('userAddress').value;

    if(!name || !phone || !address) return alert('–ë“Ø—Ö —Ç–∞–ª–±–∞—Ä—ã–≥ –±”©–≥–ª”©–Ω”© “Ø“Ø!');

    orderData = { name, phone, address, cart, total: document.getElementById('cartTotal').innerText };
    document.getElementById('summaryName').innerText = name;
    document.getElementById('summaryTotal').innerText = orderData.total;

    document.getElementById('stepInfo').classList.remove('active');
    document.getElementById('stepPayment').classList.add('active');
    document.getElementById('orderTitle').innerText = "–¢”©–ª–±”©—Ä —Ç”©–ª”©—Ö";
}

function backToInfo() {
    document.getElementById('stepPayment').classList.remove('active');
    document.getElementById('stepInfo').classList.add('active');
    document.getElementById('orderTitle').innerText = "–•“Ø—Ä–≥—ç–ª—Ç–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª";
}

function switchPayment(method, btn) {
    document.querySelectorAll('.pm-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.querySelectorAll('.pay-section').forEach(s => s.classList.remove('show'));
    document.getElementById(method).classList.add('show');
}

function completeOrder() {
    alert("–ó–∞—Ö–∏–∞–ª–≥–∞ –∞–º–∂–∏–ª—Ç—Ç–∞–π! \n–ë–∏–¥ —Ç–∞–Ω—Ç–∞–π " + orderData.phone + " –¥—É–≥–∞–∞—Ä–∞–∞—Ä —Ö–æ–ª–±–æ–≥–¥–æ—Ö –±–æ–ª–Ω–æ.");
    cart = [];
    updateCartUI();
    closeOrder();
    // Clear inputs
    document.getElementById('userName').value = '';
    document.getElementById('userPhone').value = '';
    document.getElementById('userAddress').value = '';
}

/* --- PRODUCT MODAL --- */
function openProductModal(idx) {
    const p = products[idx];
    document.getElementById('modalImg').src = p.image;
    document.getElementById('modalTitle').innerText = p.name;
    document.getElementById('modalPrice').innerText = '‚ÇÆ' + (p.isSale ? p.salePrice : p.price).toLocaleString();
    document.getElementById('modalSize').innerHTML = p.sizes.map(s => `<option>${s}</option>`).join('');
    
    document.getElementById('modalAddToCart').onclick = () => {
        addToCart(p, document.getElementById('modalSize').value);
        document.getElementById('productModal').style.display = 'none';
    };
    document.getElementById('productModal').style.display = 'flex';
}

function addToCart(product, size) {
    const existing = cart.find(i => i.name === product.name && i.size === size);
    if(existing) existing.qty++;
    else cart.push({ ...product, size, qty: 1 });
    updateCartUI();
    toggleCart(); // Auto open cart
}

// Event Listeners
document.getElementById('searchInput').oninput = (e) => { activeFilters.search = e.target.value; renderProducts(); };
document.getElementById('categoryFilter').onchange = (e) => { activeFilters.category = e.target.value; renderProducts(); };

init();
</script>
</body>
</html>